(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5514],{17131:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/safe-apps",function(){return r(45865)}])},74280:(e,t,r)=>{"use strict";r.d(t,{Sc0:()=>s.Sc0,gE_:()=>s.gE_,ip9:()=>s.ip9,o5u:()=>s.o5u,tu9:()=>s.tu9,xA9:()=>s.xA9});var s=r(39324)},25239:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var s=r(74848);r(96540);var a=r(91106),l=r.n(a),i=r(39324),n=r(86715),o=r(52332),c=r.n(o);let d=e=>{let{tabs:t}=e,r=(0,n.useRouter)(),a=Math.max(0,t.map(e=>e.href).indexOf(r.pathname)),o=r.query.safe?{safe:r.query.safe}:void 0;return(0,s.jsx)(i.tUM,{value:a,variant:"scrollable",allowScrollButtonsMobile:!0,className:c().tabs,children:t.map((e,t)=>(0,s.jsx)(i.ozo,{href:{pathname:e.href,query:o},component:l(),tabIndex:0,className:c().tab,label:(0,s.jsx)(i.o5u,{variant:"body2",fontWeight:700,color:a===t?"primary":"primary.light",className:c().label,children:e.label})},e.href))})}},54096:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(74848),a=r(22434),l=r(53373),i=r.n(l),n=r(19763),o=r.n(n);let c=e=>{let{title:t,action:r,noBorder:l}=e;return(0,s.jsxs)(a.azJ,{className:i()(o().container,{[o().border]:!l}),children:[(0,s.jsx)(a.o5u,{variant:"h3",className:o().title,children:t}),r]})}},36367:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(74848),a=r(39324);let l=e=>{let{label:t,checked:r,onChange:l,name:i}=e;return(0,s.jsx)(a.ip9,{sx:e=>{let{palette:t}=e;return{flex:1,".MuiIconButton-root:not(.Mui-checked)":{color:t.text.disabled}}},control:(0,s.jsx)(a.Sc0,{checked:r,onChange:l,name:i}),label:t})}},58261:(e,t,r)=>{"use strict";r.d(t,{H:()=>l,W:()=>s});var s=function(e){return e.GRANTED="granted",e.PROMPT="prompt",e.DENIED="denied",e}({});let a=["accelerometer","ambient-light-sensor","autoplay","battery","camera","cross-origin-isolated","display-capture","document-domain","encrypted-media","execution-while-not-rendered","execution-while-out-of-viewport","fullscreen","geolocation","gyroscope","keyboard-map","magnetometer","microphone","midi","navigation-override","payment","picture-in-picture","publickey-credentials-get","screen-wake-lock","sync-xhr","usb","web-share","xr-spatial-tracking","clipboard-read","clipboard-write","gamepad","speaker-selection"],l=e=>a.includes(e)},39966:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var s=r(74848),a=r(25239),l=r(54096),i=r(58861),n=r(19763),o=r.n(n),c=r(5259),d=r(56332),u=r(79296);let p=(0,r(22247).A)(e=>{let{safeAddress:t,chain:r}=e,n=t?i.Zt.filter(e=>(0,u.$I)(e.href,r)):i.r$;return(0,s.jsx)(l.A,{title:t?"Settings":"Preferences",action:(0,s.jsx)("div",{className:o().navWrapper,children:(0,s.jsx)(a.A,{tabs:n})})})},{safeAddress:c.A,chain:d._J})},17271:(e,t,r)=>{"use strict";r.d(t,{sW:()=>x,Nx:()=>m,M3:()=>c,Jl:()=>u});var s=r(5699),a=r(31243),l=r(58261),i=r(50184),n=r(96540),o=r(4029);let c=()=>{let[e={},t]=(0,i.A)("SafeApps__browserPermissions"),r=(0,n.useCallback)(t=>e[(0,o.Kj)(t)]||[],[e]),s=(0,n.useCallback)((r,s)=>{let a=(0,o.Kj)(r);t({...e,[a]:e[a].map(e=>{let t=s.find(t=>t.feature===e.feature);return t&&(e.status=t.selected?l.W.GRANTED:l.W.DENIED),e})})},[e,t]),a=(0,n.useCallback)(r=>{delete e[o.Kj(r)],t({...e})},[e,t]),c=(0,n.useCallback)((r,s)=>{t({...e,[(0,o.Kj)(r)]:s})},[e,t]),d=(0,n.useCallback)(e=>r(e).filter(e=>{let{status:t}=e;return t===l.W.GRANTED}).map(e=>e.feature).join("; "),[r]);return{permissions:e,getPermissions:r,updatePermission:s,addPermissions:c,removePermissions:a,getAllowedFeaturesList:d}},d="userRestricted",u=()=>{let[e={},t]=(0,i.A)("SafeApps__safePermissions"),[r,s]=(0,n.useState)(),a=(0,n.useCallback)(t=>e[(0,o.Kj)(t)]||[],[e]),c=(0,n.useCallback)((r,s)=>{let a=(0,o.Kj)(r);t({...e,[a]:e[a].map(e=>{let t=s.find(t=>t.capability===e.parentCapability);if(t){if(t.selected){var r;e.caveats=(null===(r=e.caveats)||void 0===r?void 0:r.filter(e=>e.type!==d))||[]}else h(e.caveats)||(e.caveats=[...e.caveats||[],{type:d,value:!0}])}return e})})},[e,t]),u=(0,n.useCallback)(r=>{delete e[o.Kj(r)],t({...e})},[e,t]),p=(0,n.useCallback)((t,r)=>{var s;return null===(s=e[(0,o.Kj)(t)])||void 0===s?void 0:s.some(e=>e.parentCapability===r&&!h(e.caveats))},[e]),m=(0,n.useCallback)((t,r)=>{var s;return null===(s=e[(0,o.Kj)(t)])||void 0===s?void 0:s.some(e=>e.parentCapability===r)},[e]),x=(0,n.useCallback)(a=>{if(!r)return[];let i=[...e[r.origin]||[]];return r.request.forEach(e=>{let t=Object.keys(e)[0];m(r.origin,t)?i.map(e=>{if(e.parentCapability===t){var r,s;h(e.caveats)?a===l.W.GRANTED&&(e.caveats=(null===(r=e.caveats)||void 0===r?void 0:r.filter(e=>e.type!==d))||[]):a===l.W.DENIED&&(null===(s=e.caveats)||void 0===s||s.push({type:d,value:!0}))}}):i.push({invoker:r.origin,parentCapability:t,date:new Date().getTime(),caveats:a===l.W.DENIED?[{type:d,value:!0}]:[]})}),t({...e,[r.origin]:i}),s(void 0),i},[r,e,t,m]),h=e=>!!(null==e?void 0:e.some(e=>e.type===d&&!0===e.value));return{permissions:e,isUserRestricted:h,getPermissions:a,updatePermission:c,removePermissions:u,permissionsRequest:r,setPermissionsRequest:s,confirmPermissionRequest:x,hasPermission:p}},p={[s.wq.requestAddressBook]:{displayName:"Address Book",description:"Access to your address book"}},m=e=>p[e],x=e=>({displayName:(0,a.ZH)(e).replace(/-/g," "),description:"Allow to use - ".concat(e)})},6059:(e,t,r)=>{"use strict";r.d(t,{v:()=>f});var s=r(96540),a=r(8998),l=r(3576),i=r(62079),n=r(83936);let o=e=>"".concat("customSafeApps","-").concat(e),c=()=>{let[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)(!1),c=(0,n.Ay)(),d=(0,s.useCallback)(e=>{t(e);let r=o(c);l.A.setItem(r,e.map(e=>({url:e.url})))},[c]);return(0,s.useEffect)(()=>{(async()=>{a(!0);let e=o(c),r=l.A.getItem(e)||[];t((await Promise.allSettled(r.map(e=>(0,i.yo)(e.url,c)))).filter(e=>"fulfilled"===e.status).map(e=>e.value)),a(!1)})()},[c]),{customSafeApps:e,loading:r,updateCustomSafeApps:d}};var d=r(65605),u=r(31281);let p=()=>{let e=(0,n.Ay)(),t=(0,d.GV)(t=>(0,u.Pc)(t,e)),r=(0,s.useMemo)(()=>new Set(t),[t]),a=(0,d.jL)();return{pinnedSafeAppIds:r,updatePinnedSafeApps:(0,s.useCallback)(t=>{a((0,u.HX)({pinned:Array.from(t),chainId:e}))},[a,e])}};var m=r(17271),x=r(18613);let h=(e,t)=>(0,s.useMemo)(()=>{if(!e.length)return[];let r=e.filter(e=>e.featured),s=(0,x.K1)(t);return[...new Set(r.concat(s,t))].slice(0,5)},[e]);var v=r(10256);let f=()=>{let[e=[],t,r]=(0,a.d)(),{customSafeApps:l,loading:i,updateCustomSafeApps:n}=c(),{pinnedSafeAppIds:o,updatePinnedSafeApps:d}=p(),{removePermissions:u}=(0,m.Jl)(),{removePermissions:x}=(0,m.M3)(),f=(0,s.useMemo)(()=>e.concat(l).sort((e,t)=>e.name.localeCompare(t.name)),[e,l]),b=(0,s.useMemo)(()=>e.filter(e=>o.has(e.id)),[e,o]),g=h(f,b),j=(0,s.useCallback)(e=>{n([...l,e])},[n,l]),A=(0,s.useCallback)(e=>{n(l.filter(t=>t.id!==e));let t=l.find(t=>t.id===e);t&&(u(t.url),x(t.url))},[n,l,u,x]);return{allSafeApps:f,rankedSafeApps:g,remoteSafeApps:e,remoteSafeAppsLoading:r||!(e||t),remoteSafeAppsError:t,pinnedSafeApps:b,pinnedSafeAppIds:o,togglePin:(e,t)=>{var r;let s=o.has(e),a=new Set(o),l=null===(r=f.find(t=>t.id===e))||void 0===r?void 0:r.name;s?(a.delete(e),(0,v.ai)({...v.Jz.UNPIN,label:t},l)):(a.add(e),(0,v.ai)({...v.Jz.PIN,label:t},l)),d(a)},customSafeApps:l,customSafeAppsLoading:i,addCustomApp:j,removeCustomApp:A}}},45865:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(74848),a=r(13368),l=r.n(a),i=r(6059),n=r(17271),o=r(96540),c=r(58261),d=r(39324),u=r(36367),p=r(73544);let m=()=>{let{allSafeApps:e}=(0,i.v)(),{permissions:t,updatePermission:r,removePermissions:a,isUserRestricted:l}=(0,n.Jl)(),{permissions:m,updatePermission:x,removePermissions:h}=(0,n.M3)(),v=(0,o.useMemo)(()=>Array.from(new Set(Object.keys(m).concat(Object.keys(t)))),[t,m]),f=(e,t,s)=>r(e,[{capability:t,selected:s}]),b=(e,t,r)=>x(e,[{feature:t,selected:r}]),g=(0,o.useCallback)((e,s)=>{var a,l;(null===(a=t[e])||void 0===a?void 0:a.length)&&r(e,t[e].map(e=>{let{parentCapability:t}=e;return{capability:t,selected:s}})),(null===(l=m[e])||void 0===l?void 0:l.length)&&x(e,m[e].map(e=>{let{feature:t}=e;return{feature:t,selected:s}}))},[m,t,x,r]),j=(0,o.useCallback)((e,t)=>{e.preventDefault(),g(t,!0)},[g]),A=(0,o.useCallback)((e,t)=>{e.preventDefault(),g(t,!1)},[g]),y=(0,o.useCallback)((e,t)=>{e.preventDefault(),a(t),h(t)},[h,a]),_=(0,o.useMemo)(()=>e.reduce((e,t)=>(e[t.url]=t.name,e),{}),[e]);return e.length?(0,s.jsxs)(d.tu9,{sx:{padding:4},children:[(0,s.jsx)(d.o5u,{variant:"h4",fontWeight:700,children:"Safe Apps permissions"}),(0,s.jsx)("br",{}),!v.length&&(0,s.jsx)(d.o5u,{variant:"body1",sx:{color:e=>{let{palette:t}=e;return t.primary.light}},children:"There are no Safe Apps using permissions."}),v.map(e=>{var r,a;return(0,s.jsxs)(d.xA9,{item:!0,sx:e=>{let{palette:t,shape:r}=e;return{border:"1px solid ".concat(t.border.light),borderRadius:r.borderRadius,marginBottom:"16px"}},children:[(0,s.jsxs)(d.xA9,{container:!0,sx:e=>{let{palette:t}=e;return{padding:"15px 24px",borderBottom:"1px solid ".concat(t.border.light)}},children:[(0,s.jsxs)(d.xA9,{item:!0,xs:12,sm:5,sx:{padding:"9px 0"},children:[(0,s.jsx)(d.o5u,{variant:"h5",fontWeight:700,children:_[e]}),(0,s.jsx)(d.o5u,{variant:"body2",children:e})]}),(0,s.jsxs)(d.xA9,{container:!0,item:!0,xs:12,sm:7,children:[null===(r=t[e])||void 0===r?void 0:r.map(t=>{let{parentCapability:r,caveats:a}=t;return(0,s.jsx)(d.xA9,{item:!0,xs:12,sm:6,lg:4,xl:3,children:(0,s.jsx)(u.A,{name:r,label:(0,n.Nx)(r).displayName,onChange:(t,s)=>f(e,r,s),checked:!l(a)})},r)}),null===(a=m[e])||void 0===a?void 0:a.map(t=>{let{feature:r,status:a}=t;return(0,s.jsx)(d.xA9,{item:!0,xs:12,sm:6,lg:4,xl:3,children:(0,s.jsx)(u.A,{name:r.toString(),label:(0,n.sW)(r).displayName,onChange:(t,s)=>b(e,r,s),checked:a===c.W.GRANTED})},r)})]})]}),(0,s.jsxs)(d.xA9,{container:!0,item:!0,justifyContent:"flex-end",sx:{padding:"12px 24px"},children:[(0,s.jsx)(d.N_E,{href:"#",onClick:t=>j(t,e),sx:{textDecoration:"none"},children:"Allow all"}),(0,s.jsx)(d.N_E,{href:"#",color:"error",onClick:t=>A(t,e),sx:{textDecoration:"none"},ml:2,children:"Clear all"}),(0,s.jsx)(d.N_E,{href:"#",color:"error",onClick:t=>y(t,e),ml:2,children:(0,s.jsx)(d.Ahz,{component:p.A,inheritViewBox:!0,color:"error",fontSize:"small"})})]})]},e)})]}):(0,s.jsx)("div",{})};var x=r(39966),h=r(24203),v=r(10256),f=r(65605),b=r(42837),g=r(74280),j=r(11100);let A=()=>{let e=(0,f.GV)(b.gB),t=(0,f.jL)();return(0,s.jsx)(g.tu9,{sx:{padding:4,mt:2},children:(0,s.jsxs)(g.xA9,{container:!0,spacing:3,children:[(0,s.jsx)(g.xA9,{item:!0,lg:4,xs:12,children:(0,s.jsx)(g.o5u,{variant:"h4",fontWeight:"bold",mb:1,children:"Signing method"})}),(0,s.jsxs)(g.xA9,{item:!0,xs:!0,children:[(0,s.jsxs)(g.o5u,{mb:2,children:["This setting determines how the ",j.Az," will sign message requests from Safe Apps. Gasless, off-chain signing is used by default. Learn more about message signing"," ",(0,s.jsx)(h.A,{href:j.tF.SIGNED_MESSAGES,children:"here"}),"."]}),(0,s.jsx)(g.gE_,{children:(0,s.jsx)(g.ip9,{sx:e=>{let{palette:t}=e;return{flex:1,".MuiIconButton-root:not(.Mui-checked)":{color:t.text.disabled}}},control:(0,s.jsx)(g.Sc0,{checked:e,onChange:()=>{(0,v.sx)(v.kd.SAFE_APPS.CHANGE_SIGNING_METHOD),t((0,b.c6)(!e))},name:"use-on-chain-signing"}),label:"Always use on-chain signatures"})})]})]})})},y=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{children:(0,s.jsx)("title",{children:"".concat(j.Az," – Settings – Safe Apps")})}),(0,s.jsx)(x.A,{}),(0,s.jsxs)("main",{children:[(0,s.jsx)(m,{}),(0,s.jsx)(A,{})]})]})},62079:(e,t,r)=>{"use strict";r.d(t,{yo:()=>c});var s=r(4029),a=r(8442);let l=e=>{let t=e.find(e=>{var t;return(null==e?void 0:null===(t=e.sizes)||void 0===t?void 0:t.includes("any"))||(null==e?void 0:e.type)==="image/svg+xml"});if(t)return t.src;for(let t of e)for(let e of t.sizes.split(" "))if(Number(e.split("x")[0])>=128)return t.src;return e[0].src||""},i=(e,t)=>{let{icons:r=[],iconPath:a=""}=t,i=r.length?l(r):a;return i.startsWith("https://")?i:"".concat(e).concat((0,s.cW)(i)?"":"/").concat(i)},n=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=(0,s.Kj)(e),a="".concat(r,"/manifest.json"),l=new AbortController,i=setTimeout(()=>l.abort(),t),n=await fetch(a,{signal:l.signal});if(clearTimeout(i),!n.ok)throw Error("Failed to fetch manifest from ".concat(a));return n.json()},o=e=>null!=e&&"object"==typeof e&&"name"in e&&"description"in e&&("icons"in e||"iconPath"in e),c=async(e,t)=>{let r=(0,s.Kj)(e),l=await n(e);if(!o(l))throw Error("Invalid Safe App manifest");let c=i(r,l);return{id:Math.round(1e9*Math.random()+1e6),url:r,name:l.name,description:l.description,accessControl:{type:a.SafeAppAccessPolicyTypes.NoRestrictions},tags:[],features:[],socialProfiles:[],developerWebsite:"",chainIds:[t],iconUrl:c,safeAppsPermissions:l.safe_apps_permissions||[]}}},18613:(e,t,r)=>{"use strict";r.d(t,{K1:()=>c,bq:()=>n,zU:()=>i});var s=r(3576);let a="SafeApps__dashboard",l=()=>s.A.getItem(a)||{},i=e=>{var t,r,i,n;let o=l(),c=null!==(i=null===(t=o[e])||void 0===t?void 0:t.openCount)&&void 0!==i?i:0,d=null!==(n=null===(r=o[e])||void 0===r?void 0:r.txCount)&&void 0!==n?n:0;s.A.setItem(a,{...o,[e]:{timestamp:Date.now(),openCount:c+1,txCount:d}})},n=e=>{var t,r;let i=l(),n=null!==(r=null===(t=i[e])||void 0===t?void 0:t.txCount)&&void 0!==r?r:0;s.A.setItem(a,{...i,[e]:{...i[e],txCount:n+1}})},o=(e,t,r,s,a)=>s+(e-t)*(a-s)/(r-t),c=e=>Object.entries(d(l())).sort((e,t)=>t[1]-e[1]).map(t=>e.find(e=>String(e.id)===t[0])).filter(Boolean),d=e=>{let t={},r=Object.entries(e).sort((e,t)=>e[1].timestamp-t[1].timestamp);for(let[e,s]of Array.from(r.entries())){let a=o(e,0,r.length,1,2);t[s[0]]=(2*s[1].txCount+1*s[1].openCount)*a}return t}},52332:e=>{e.exports={tabs:"styles_tabs__8AoqD",tab:"styles_tab__WjqMe",label:"styles_label__D53iN"}},19763:e=>{e.exports={container:"styles_container__sGid8",title:"styles_title___s0jt",border:"styles_border__BkX1U",pageHeader:"styles_pageHeader__fRL7d",actionsWrapper:"styles_actionsWrapper__g_Tq2",navWrapper:"styles_navWrapper__XNqgs"}}},e=>{var t=t=>e(e.s=t);e.O(0,[5699,636,6593,8792],()=>t(17131)),_N_E=e.O()}]);
//# sourceMappingURL=safe-apps-33f1ba8028185f75.js.map