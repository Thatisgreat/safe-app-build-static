(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{17397:(e,a,t)=>{"use strict";t.d(a,{FcD:()=>r.FcD,XL1:()=>r.XL1,azJ:()=>r.azJ});var r=t(39324)},4347:(e,a,t)=>{"use strict";t.d(a,{Ahz:()=>r.Ahz,m_M:()=>r.m_M,o5u:()=>r.o5u});var r=t(39324)},38885:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});var r=t(74848);t(96540);var s=t(85197);let n=e=>{let{name:a,value:t}=e;return(0,r.jsxs)(r.Fragment,{children:[a&&(0,r.jsx)(s.xA9,{item:!0,xs:3,children:(0,r.jsx)(s.o5u,{variant:"body2",children:a})}),(0,r.jsx)(s.xA9,{item:!0,xs:a?9:12,children:t})]})}},3960:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});var r=t(74848),s=t(17397),n=t(56332),i=t(45052),o=t(22671);let l=e=>{let{action:a}=e,t=(0,n._J)(),l=(0,o.A)();return t&&l?(0,r.jsxs)(s.FcD,{severity:"warning",children:[(0,r.jsx)(s.XL1,{sx:{fontWeight:700},children:"Change your wallet network"}),"You are trying to"," ",a||"sign or execute a transaction"," on ",t.chainName,". Make sure that your wallet is set to the same network.",(0,r.jsx)(s.azJ,{sx:{mt:2},children:(0,r.jsx)(i.A,{})})]}):null}},130:(e,a,t)=>{"use strict";t.d(a,{dz:()=>K,GT:()=>q,Ay:()=>Q});var r=t(74848),s=t(73536),n=t(12929),i=t(76285),o=t(8220),l=t(50836),c=t(44894),d=t(49276),x=t(28213),u=t(15652),h=t(10583);let m=async(e,a,t,r)=>{let s=!0,n=t.map(a=>({rpcUrl:(null==e?void 0:e[a.chainId])||(0,x.C$)(a.rpcUri),chainId:a.chainId}));for(let e of t){var i;let t;let o=null===(i=n.find(a=>e.chainId===a.chainId))||void 0===i?void 0:i.rpcUrl;if(!o)throw Error("No RPC available for  ".concat(e.chainName));let m=(0,x.OC)(e,o);if(!m)throw Error("Could not initiate RPC");if(t=e.chainId===h.A.zksync?await (0,l.n)(o,{safeAccountConfig:a.safeAccountConfig,saltNonce:a.saltNonce},e,a.safeVersion):await (0,u.$2)(a,m),r.some(e=>(0,d.xU)(e,t))||await (0,c.gN)(t,m)){s=!1;break}}return s?a.saltNonce:m(e,{...a,saltNonce:(Number(a.saltNonce)+1).toString()},t,r)};var y=t(82177),g=t.n(y),v=t(50704),j=t.n(v),w=t(23807),A=t(50007),f=t(38885),p=t(36420),P=t(29005),_=t(83561),F=t(3108),I=t(56332),N=t(22671),G=t(27566),E=t(45943),k=t(20781),b=t(10256),C=t(25502),L=t(55155),S=t(65605),R=t(79296),z=t(54505),M=t(61759),T=t(39324),J=t(53373),B=t.n(J),Y=t(86715),D=t(96540),U=t(186),V=t(3960),$=t(16652),X=t(894),W=t.n(X),H=t(42837),Z=t(95347),O=t(29380);let K=e=>{let{totalFee:a,chain:t,isWaived:s,inline:n=!1}=e;return(0,r.jsx)(T.azJ,{className:B()(g().networkFee,{[g().networkFeeInline]:n}),children:(0,r.jsx)(T.o5u,{className:B()({[g().strikethrough]:s}),children:(0,r.jsxs)("b",{children:["â‰ˆ ",a," ",null==t?void 0:t.nativeCurrency.symbol]})})})},q=e=>{let{name:a,owners:t,threshold:n,networks:o}=e;return(0,r.jsxs)(T.xA9,{container:!0,spacing:3,children:[(0,r.jsx)(f.A,{name:o.length>1?"Networks":"Network",value:(0,r.jsx)(T.m_M,{title:(0,r.jsx)(T.azJ,{children:o.map(e=>(0,r.jsx)(T.azJ,{sx:{p:"4px 0px"},children:(0,r.jsx)(U.A,{chainId:e.chainId})},e.chainId))}),arrow:!0,children:(0,r.jsx)(T.azJ,{"data-testid":"network-list",sx:{display:"inline-block"},children:(0,r.jsx)(i.A,{networks:o})})})}),a&&(0,r.jsx)(f.A,{name:"Name",value:(0,r.jsx)(T.o5u,{"data-testid":"review-step-safe-name",children:a})}),(0,r.jsx)(f.A,{name:"Signers",value:(0,r.jsx)(T.azJ,{"data-testid":"review-step-owner-info",className:g().ownersArray,children:t.map((e,a)=>(0,r.jsx)(s.A,{address:e.address,name:e.name||e.ens,shortAddress:!1,showPrefix:!1,showName:!0,hasExplorer:!0,showCopyButton:!0},a))})}),(0,r.jsx)(f.A,{name:"Threshold",value:(0,r.jsxs)(T.o5u,{"data-testid":"review-step-threshold",children:[n," out of ",t.length," ",t.length>1?"signers":"signer"]})})]})},Q=e=>{let{data:a,onSubmit:t,onBack:s,setStep:i}=e,d=(0,N.A)();(0,A.A)(i,a.networks);let y=(0,I._J)(),v=(0,k.Ay)(),J=(0,S.jL)(),B=(0,Y.useRouter)(),[U]=(0,o.Ay)(),X=(0,S.GV)(H._G),[Q,ee]=(0,D.useState)(_.I.PayLater),[ea,et]=(0,D.useState)(P.S.RELAY),[er,es]=(0,D.useState)(!1),[en,ei]=(0,D.useState)(),eo=(0,I.eZ)(R.Gv.COUNTERFACTUAL),el=y&&(0,R.jI)(y,R.Gv.EIP1559),ec=(0,D.useMemo)(()=>a.owners.map(e=>e.address),[a.owners]),[ed]=(0,G.x6)(ec),ex=a.networks.length>1,eu=(0,z.v)(ed),eh=eu&&ea===P.S.RELAY,em=(0,D.useMemo)(()=>y?(0,l.bo)(a.safeVersion,{owners:a.owners.map(e=>e.address),threshold:a.threshold,paymentReceiver:a.paymentReceiver},y):void 0,[y,a.owners,a.safeVersion,a.threshold,a.paymentReceiver]),ey=(0,D.useMemo)(()=>em?{...em,saltNonce:Date.now().toString()}:void 0,[em]),{gasLimit:eg}=(0,w.Z)(ey,a.safeVersion),ev=null==U?void 0:U.maxFeePerGas,ej=null==U?void 0:U.maxPriorityFeePerGas,ew=(0,E.A)({gasLimit:eg,maxFeePerGas:ev}),eA=(0,o.$c)(ev,eg,y),ef=(0,$.Ay)(),ep=(0,D.useMemo)(()=>W()(null==ef?void 0:ef.map(e=>e.address)),[ef]),eP=(0,S.GV)(H._G),e_=async()=>{try{let e;if(!v||!y||!em)return;es(!0);let t=void 0!==a.saltNonce?a.saltNonce.toString():await m(eP,{...em,saltNonce:"0"},a.networks,ep),r={...em,saltNonce:t},s=X[y.chainId],i=(0,x.OC)(y,s);if(!i)return;for(let n of(e=y.chainId===h.A.zksync?await (0,l.n)(s||(0,x.C$)(y.rpcUri),{safeAccountConfig:r.safeAccountConfig,saltNonce:t},y,r.safeVersion):await (0,u.$2)(r,i),a.networks))await eF(n,r,e);J((0,O.v)(a.networks.map(e=>e.chainId),e,a.name,a.owners,a.threshold)),(0,C.T5)(y.chainId),eo&&Q===_.I.PayLater&&(await (null==B?void 0:B.push({pathname:Z.S.home,query:{safe:"".concat(a.networks[0].shortName,":").concat(e)}})),(0,n.p5)(n.Zf.AWAITING_EXECUTION,{groupKey:F.Xh,safeAddress:e,networks:a.networks}))}catch(e){console.error(e),ei("Error creating the Safe Account. Please try again later.")}finally{es(!1)}},eF=async(e,r,s)=>{if(v){(0,C.T5)(e.chainId);try{if(eo&&Q===_.I.PayLater){(0,C.cs)(s),(0,b.sx)({...b.kg.PROCEED_WITH_TX,label:"counterfactual",category:b.kN}),(0,F.M$)(e.chainId,s,r,a.name,J,Q),(0,b.sx)({...b.$t.CREATED_SAFE,label:"counterfactual"});return}let i=el?{maxFeePerGas:null==ev?void 0:ev.toString(),maxPriorityFeePerGas:null==ej?void 0:ej.toString(),gasLimit:null==eg?void 0:eg.toString()}:{gasPrice:null==ev?void 0:ev.toString(),gasLimit:null==eg?void 0:eg.toString()},o=async(i,o)=>{(0,F.M$)(e.chainId,s,r,a.name,J,Q),i&&(0,n.p5)(n.Zf.RELAYING,{groupKey:F.Xh,taskId:i,safeAddress:s}),o&&(0,n.p5)(n.Zf.PROCESSING,{groupKey:F.Xh,txHash:o,safeAddress:s}),(0,b.sx)(b.$t.SUBMIT_CREATE_SAFE),(0,b.sx)({...b.kg.PROCEED_WITH_TX,label:"deployment",category:b.kN}),t(a)};if(eh){let a=await (0,l.ST)(e,r);o(a)}else await (0,l.sZ)(v.provider,r,a.safeVersion,e,i,e=>{o(void 0,e)},!0)}catch(a){let e=(0,L.z)(a);ei((0,c.jG)(e)?"User rejected signing.":"Error creating the Safe Account. Please try again later."),(0,c.jG)(e)&&(0,b.sx)(b.$t.REJECT_CREATE_SAFE)}es(!1)}},eI=d&&Q===_.I.PayNow&&!eh&&!ex||d&&!eo&&!ex,eN=eI||er;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T.azJ,{"data-testid":"safe-setup-overview",className:j().row,children:(0,r.jsx)(q,{name:a.name,owners:a.owners,threshold:a.threshold,networks:a.networks})}),eo&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T.cGx,{}),(0,r.jsxs)(T.azJ,{"data-testid":"pay-now-later-message-box",className:j().row,children:[(0,r.jsx)(_.A,{totalFee:eA,isMultiChain:ex,canRelay:eu,payMethod:Q,setPayMethod:ee}),eu&&Q===_.I.PayNow&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(T.xA9,{container:!0,spacing:3,sx:{pt:2},children:(0,r.jsx)(f.A,{value:(0,r.jsx)(P.Z,{executionMethod:ea,setExecutionMethod:et,relays:ed})})})}),eI&&(0,r.jsx)(T.azJ,{sx:{"&:not(:empty)":{mt:3}},children:(0,r.jsx)(V.A,{action:"create a Safe Account"})}),Q===_.I.PayNow&&(0,r.jsx)(T.xA9,{item:!0,children:(0,r.jsxs)(T.o5u,{component:"div",sx:{mt:2},children:["You will have to confirm a transaction and pay an estimated fee of"," ",(0,r.jsx)(K,{totalFee:eA,isWaived:eh,chain:y,inline:!0})," with your connected wallet"]})})]})]}),!eo&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T.cGx,{}),(0,r.jsxs)(T.azJ,{className:j().row,sx:{display:"flex",flexDirection:"column",gap:3},children:[eu&&(0,r.jsx)(T.xA9,{container:!0,spacing:3,children:(0,r.jsx)(f.A,{name:"Execution method",value:(0,r.jsx)(P.Z,{executionMethod:ea,setExecutionMethod:et,relays:ed})})}),(0,r.jsx)(T.xA9,{"data-testid":"network-fee-section",container:!0,spacing:3,children:(0,r.jsx)(f.A,{name:"Est. network fee",value:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(K,{totalFee:eA,isWaived:eh,chain:y}),!eh&&(0,r.jsx)(T.o5u,{variant:"body2",sx:{color:"text.secondary",mt:1},children:"You will have to confirm a transaction with your connected wallet."})]})})}),eI&&(0,r.jsx)(V.A,{action:"create a Safe Account"}),!ew&&!eh&&(0,r.jsx)(p.A,{children:"Your connected wallet doesn't have enough funds to execute this transaction"})]})]}),(0,r.jsx)(T.cGx,{}),(0,r.jsxs)(T.azJ,{className:j().row,children:[en&&(0,r.jsx)(p.A,{className:g().errorMessage,children:en}),(0,r.jsxs)(T.azJ,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",gap:3},children:[(0,r.jsx)(T.$nd,{"data-testid":"back-btn",variant:"outlined",size:"small",onClick:()=>{s(a)},startIcon:(0,r.jsx)(M.A,{fontSize:"small"}),children:"Back"}),(0,r.jsx)(T.$nd,{"data-testid":"review-step-next-btn",onClick:e_,variant:"contained",size:"stretched",disabled:eN,children:er?(0,r.jsx)(T.PaH,{size:18}):"Create account"})]})]})]})}},23807:(e,a,t)=>{"use strict";t.d(a,{Z:()=>l});var r=t(28213),s=t(20781),n=t(56680),i=t(56332),o=t(50836);let l=(e,a)=>{let t=(0,r.vH)(),l=(0,i._J)(),c=(0,s.Ay)(),[d,x,u]=(0,n.A)(()=>{if((null==c?void 0:c.address)&&l&&t&&e)return(0,o.a_)(l,t,c.address,e,a)},[null==c?void 0:c.address,l,t,e,a]);return{gasLimit:d,gasLimitError:x,gasLimitLoading:u}}},50007:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var r=t(96540),s=t(20781),n=t(56332);let i=(e,a)=>{let t=(0,s.Ay)(),i=(0,n._J)();(0,r.useEffect)(()=>{if(!t||1===a.length&&(null==i?void 0:i.chainId)!==a[0].chainId){e(0);return}},[null==i?void 0:i.chainId,a,e,t])}},29005:(e,a,t)=>{"use strict";t.d(a,{S:()=>N,Z:()=>G});var r=t(74848),s=t(39324),n=t(20781),i=t(41466),o=t(10583),l=t(13270),c=t.n(l);let d={[o.A.gno]:{name:"Gnosis",logo:"/images/common/gnosis-chain-logo.png"},default:{name:"Safe",logo:"/images/logo-no-text.svg"}},x=e=>{let{chainId:a}=e,t=d[a]||d.default;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{src:t.logo,alt:t.name,className:c().logo})," ",t.name]})};var u=t(4347),h=t(15542),m=t(27566),y=t(93552),g=t.n(y),v=t(31243);let j=e=>{var a,t;let{relays:s,tooltip:n}=e;if(!n){let e=null!==(a=null==s?void 0:s.limit)&&void 0!==a?a:m.pl;n="".concat(e," transaction").concat((0,v.Tz)(e)," per day for free")}return(0,r.jsx)("div",{className:g().container,children:(0,r.jsxs)(u.o5u,{variant:"body2",color:"primary.light",display:"flex",alignItems:"center",gap:.5,children:[(0,r.jsx)("b",{children:null!==(t=null==s?void 0:s.remaining)&&void 0!==t?t:m.pl})," free transactions left today",(0,r.jsx)(u.m_M,{title:n,placement:"top",arrow:!0,children:(0,r.jsx)("span",{style:{lineHeight:0},children:(0,r.jsx)(u.Ahz,{component:h.A,inheritViewBox:!0,color:"info",fontSize:"small",sx:{color:"#B2B5B2"}})})})]})})};var w=t(40986),A=t.n(w),f=t(71395),p=t(4568),P=t(37015);let _=()=>{let[e]=(0,p.A)();return(0,r.jsx)("div",{className:g().container,children:(0,r.jsxs)(f.o5u,{variant:"body2",color:"primary.light",children:[(0,r.jsx)("b",{children:"Wallet balance:"})," ",(0,r.jsx)(P.A,{balance:e})]})})};var F=t(22247),I=t(56332),N=function(e){return e.RELAY="RELAY",e.WALLET="WALLET",e}({});let G=(0,F.A)(e=>{var a;let{wallet:t,chain:n,executionMethod:o,setExecutionMethod:l,relays:c,noLabel:d,tooltip:u}=e,h="RELAY"===o;return(0,r.jsxs)(s.azJ,{className:A().container,sx:{borderRadius:e=>{let{shape:a}=e;return"".concat(a.borderRadius,"px")}},children:[(0,r.jsx)("div",{className:A().method,children:(0,r.jsxs)(s.MJN,{sx:{display:"flex"},children:[d?null:(0,r.jsx)(s.o5u,{variant:"body2",className:A().label,children:"Who will pay gas fees:"}),(0,r.jsxs)(s.z6M,{row:!0,value:o,onChange:(e,a)=>{l(a)},children:[(0,r.jsx)(s.ip9,{"data-testid":"relay-execution-method",sx:{flex:1},value:"RELAY",label:(0,r.jsxs)(s.o5u,{className:A().radioLabel,whiteSpace:"nowrap",children:["Sponsored by",(0,r.jsx)(x,{chainId:null!==(a=null==n?void 0:n.chainId)&&void 0!==a?a:""})]}),control:(0,r.jsx)(s.sxL,{})}),(0,r.jsx)(s.ip9,{"data-testid":"connected-wallet-execution-method",sx:{flex:1},value:"WALLET",label:(0,r.jsxs)(s.o5u,{className:A().radioLabel,children:[(0,r.jsx)(i.A,{provider:(null==t?void 0:t.label)||"",width:20,height:20,icon:null==t?void 0:t.icon})," Connected wallet"]}),control:(0,r.jsx)(s.sxL,{})})]})]})}),h&&c?(0,r.jsx)(j,{relays:c,tooltip:u}):t?(0,r.jsx)(_,{}):null]})},{wallet:n.Ay,chain:I._J})},8220:(e,a,t)=>{"use strict";t.d(a,{$c:()=>f,Ay:()=>p,N4:()=>A});var r=t(31243),s=t(8442),n=t(56680),i=t(56332),o=t(76263),l=t(28213),c=t(21886),d=t(79296),x=t(55155);let u=e=>"FastGasPrice"in e&&"suggestBaseFee"in e,h=(e,a)=>{let t=BigInt(Number(e.FastGasPrice)*Number(a));return{maxFeePerGas:t,maxPriorityFeePerGas:t-BigInt(Number(e.suggestBaseFee)*Number(a))}},m=async e=>{let{uri:a,gasParameter:t,gweiFactor:r}=e,s=await fetch(a);if(!s.ok)throw Error("Error fetching gas price from oracle ".concat(a));let n=await s.json(),i=n.data||n.result||n;return u(i)?h(i,r):{gasPrice:BigInt(i[t]*Number(r))}},y=e=>e.type.toUpperCase()==s.GAS_PRICE_TYPE.FIXED,g=e=>e.type.toUpperCase()==s.GAS_PRICE_TYPE.FIXED_1559,v=e=>e.type.toUpperCase()==s.GAS_PRICE_TYPE.ORACLE,j=async e=>{let a;for(let t of e){if(y(t))return{gasPrice:BigInt(t.weiValue)};if(g(t))return{maxFeePerGas:BigInt(t.maxFeePerGas),maxPriorityFeePerGas:BigInt(t.maxPriorityFeePerGas)};if(v(t))try{return await m(t)}catch(e){a=(0,x.z)(e),(0,c.vV)(c.I._611,a.message);continue}}if(a)throw a},w=(e,a,t)=>e?t&&"maxFeePerGas"in e&&"maxPriorityFeePerGas"in e?e:"gasPrice"in e?{maxFeePerGas:e.gasPrice,maxPriorityFeePerGas:t?null==a?void 0:a.maxPriorityFeePerGas:void 0}:{maxFeePerGas:void 0,maxPriorityFeePerGas:void 0}:{maxFeePerGas:t?null==a?void 0:a.maxFeePerGas:null==a?void 0:a.gasPrice,maxPriorityFeePerGas:t?null==a?void 0:a.maxPriorityFeePerGas:void 0},A=(e,a)=>e*BigInt(a),f=(e,a,t)=>a&&e?(0,r.q5)(A(e,a),null==t?void 0:t.nativeCurrency.decimals):"> 0.001",p=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=(0,i._J)(),t=null==a?void 0:a.gasPrice,[r]=(0,o.A)(2e4),s=(0,l.vH)(),c=!!a&&(0,d.jI)(a,d.Gv.EIP1559),[x,u,h]=(0,n.A)(async()=>{let[a,r]=await Promise.all([t?j(t):void 0,null==s?void 0:s.getFeeData()]),n=w(a,r,c);return e?c&&n.maxFeePerGas&&n.maxPriorityFeePerGas?{maxFeePerGas:n.maxFeePerGas+(2n*n.maxPriorityFeePerGas-n.maxPriorityFeePerGas),maxPriorityFeePerGas:2n*n.maxPriorityFeePerGas}:{maxFeePerGas:n.maxFeePerGas?150n*n.maxFeePerGas/100n:void 0,maxPriorityFeePerGas:void 0}:n},[t,s,r,c],!1);return[x,u,h||!x&&!u]}},27566:(e,a,t)=>{"use strict";t.d(a,{iV:()=>c,pl:()=>l,x6:()=>d});var r=t(56680),s=t(6459),n=t(79296),i=t(56332),o=t(8442);let l=5,c=()=>{let e=(0,i._J)(),{safe:a,safeAddress:t}=(0,s.A)();return(0,r.A)(()=>{if(t&&e&&(0,n.jI)(e,n.Gv.RELAYING))return(0,o.getRelayCount)(e.chainId,t)},[e,t,a.txHistoryTag])},d=e=>{let a=(0,i._J)(),{safe:t}=(0,s.A)();return(0,r.A)(()=>{if(a&&(0,n.jI)(a,n.Gv.RELAYING))return Promise.all(e.map(e=>(0,o.getRelayCount)(a.chainId,e))).then(e=>{let a=Math.min(...e.map(e=>e.remaining));return e.find(e=>e.remaining===a)}).catch(()=>({remaining:0,limit:l}))},[a,e,t.txHistoryTag])}},45943:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});var r=t(8220),s=t(4568);let n=e=>{let{gasLimit:a,maxFeePerGas:t}=e,[n]=(0,s.A)();return void 0===a||null==t||void 0===n||n>=(0,r.N4)(t,a)}},4568:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var r=t(56680),s=t(20781),n=t(28213);let i=()=>{let e=(0,n.vH)(),a=(0,s.Ay)();return(0,r.A)(async()=>{if(a&&e)return await e.getBalance(a.address,"latest")},[a,e])}},54505:(e,a,t)=>{"use strict";t.d(a,{v:()=>r});let r=e=>!!e&&e.remaining>0},82177:e=>{e.exports={ownersArray:"styles_ownersArray__Lwugg",strikethrough:"styles_strikethrough__dsfcO",errorMessage:"styles_errorMessage__EgiJf",networkFee:"styles_networkFee__s25eL",networkFeeInline:"styles_networkFeeInline__o4u72"}},50704:e=>{e.exports={row:"styles_row__UGXjL"}},93552:e=>{e.exports={container:"styles_container__89vKx"}},40986:e=>{e.exports={container:"styles_container__uq_oY",method:"styles_method__e_FVs",label:"styles_label__DK6kD",radioLabel:"styles_radioLabel__LApjP"}},13270:e=>{e.exports={sponsoredBy:"styles_sponsoredBy__0eMhp",icon:"styles_icon__MhBil",logo:"styles_logo___DNjH"}}}]);
//# sourceMappingURL=130-e70baf555ae9f5f6.js.map